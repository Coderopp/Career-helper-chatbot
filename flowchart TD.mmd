flowchart TD
    %% Start Flow
    A[ðŸ‘‹ Welcome Screen] --> B{User Ready?}
    B -->|Yes| C[ðŸ“ Context Check]
    B -->|Maybe Later| Z[ðŸ’­ End Session]
    
    %% Context Check Stage
    C --> D{Select Stage}
    D -->|Student| E[ðŸŽ“ Student Path]
    D -->|College Student| F[ðŸ“š College Path]
    D -->|Professional| G[ðŸ’¼ Professional Path]
    D -->|Career Switcher| H[ðŸ”„ Switcher Path]
    
    %% Interest Exploration Stage
    E --> I[ðŸ” Interest Exploration]
    F --> I
    G --> I
    H --> I
    
    I --> J{Input Method}
    J -->|Categories| K[ðŸ“Š Category Selection]
    J -->|Freeform| L[âœï¸ Text Input]
    J -->|Both| M[ðŸ”— Combined Input]
    
    %% LLM Analysis Stage
    K --> N[ðŸ§  LLM Analysis]
    L --> N
    M --> N
    
    N --> O{LLM Available?}
    O -->|Yes| P[âš¡ AI Processing]
    O -->|No| Q[ðŸ”„ Fallback Analysis]
    
    %% Preference Extraction
    P --> R[ðŸ“‹ Preference Extraction]
    R --> S[ðŸŽ¯ Interest Analysis]
    R --> T[ðŸ› ï¸ Skill Assessment]
    R --> U[ðŸ’Ž Value Identification]
    
    %% Confidence Assessment
    S --> V{Confidence Check}
    T --> V
    U --> V
    
    V -->|High| W[âœ… High Confidence]
    V -->|Medium| X[âš ï¸ Medium Confidence]
    V -->|Low| Y[â“ Low Confidence]
    
    %% Career Matching
    W --> AA[ðŸŽ¯ Career Matching]
    X --> AA
    Y --> BB[â“ Clarifying Questions]
    
    BB --> I
    Q --> AA
    
    %% Career Recommendation Engine
    AA --> CC{Matching Method}
    CC -->|LLM Mapping| DD[ðŸ¤– AI Career Mapping]
    CC -->|Vector Search| EE[ðŸ” Semantic Search]
    
    DD --> FF[ðŸ“Š Domain Analysis]
    FF --> GG{Career Domain}
    GG -->|STEM| HH[ðŸ’» STEM Careers]
    GG -->|Arts| II[ðŸŽ¨ Creative Careers]
    GG -->|Sports| JJ[âš½ Sports Careers]
    GG -->|General| KK[ðŸŒ General Careers]
    
    %% Vector Search Path
    EE --> LL[ðŸ”¢ Embedding Generation]
    LL --> MM[ðŸ“ Similarity Calculation]
    MM --> NN[ðŸŽ¯ Top Matches]
    
    %% Results Convergence
    HH --> OO[ðŸ“‹ Career Results]
    II --> OO
    JJ --> OO
    KK --> OO
    NN --> OO
    
    %% Results Evaluation
    OO --> PP{Results Found?}
    PP -->|Yes| QQ[âœ… Display Careers]
    PP -->|No| RR[ðŸ”„ Refine Search]
    
    RR --> BB
    
    %% Career Detail Exploration
    QQ --> SS[ðŸ“– Career Details]
    SS --> TT{User Action}
    TT -->|View Details| UU[ðŸ“Š Detailed View]
    TT -->|Explore More| VV[ðŸ” More Careers]
    TT -->|Get Report| WW[ðŸ“„ PDF Generation]
    TT -->|Next Steps| XX[ðŸš€ Action Planning]
    
    %% Detailed Career View
    UU --> YY[ðŸ‘¤ Personalized Explanation]
    UU --> ZZ[ðŸ› ï¸ Skills Breakdown]
    UU --> AAA[ðŸŽ“ Education Requirements]
    UU --> BBB[ðŸ’° Salary Information]
    UU --> CCC[ðŸ¢ Companies & Opportunities]
    UU --> DDD[ðŸ“ˆ Career Progression]
    UU --> EEE[ðŸŽ¯ Personality Match]
    
    %% User Actions from Detail View
    YY --> FFF{Next Action}
    ZZ --> FFF
    AAA --> FFF
    BBB --> FFF
    CCC --> FFF
    DDD --> FFF
    EEE --> FFF
    
    FFF -->|Back to List| VV
    FFF -->|New Search| I
    FFF -->|Get PDF| WW
    FFF -->|Next Steps| XX
    
    %% More Careers Exploration
    VV --> GGG[ðŸ“Š Alternative Careers]
    GGG --> QQ
    
    %% PDF Report Generation
    WW --> HHH[ðŸ“ Generate Summary]
    HHH --> III[ðŸ“‹ Action Items]
    III --> JJJ[ðŸ“Š Career Comparison]
    JJJ --> KKK[ðŸ“„ Download PDF]
    KKK --> XX
    
    %% Next Steps & Action Planning
    XX --> LLL[ðŸŽ¯ Immediate Actions]
    XX --> MMM[ðŸ“š Learning Resources]
    XX --> NNN[â° Timeline Planning]
    XX --> OOO[ðŸ”— External Links]
    
    %% Final Actions
    LLL --> PPP{Continue?}
    MMM --> PPP
    NNN --> PPP
    OOO --> PPP
    
    PPP -->|Explore More| I
    PPP -->|Start Over| A
    PPP -->|End Session| QQQ[âœ¨ Success End]
    
    %% End States
    Z --> RRR[ðŸ˜´ Session Paused]
    QQQ --> SSS[ðŸŽ‰ Goals Achieved]
    
    %% Progress Tracking (Side annotations)
    A -.-> T1[Step 1/9]
    C -.-> T2[Step 2/9]
    I -.-> T3[Step 3/9]
    N -.-> T4[Step 4/9]
    AA -.-> T5[Step 5/9]
    QQ -.-> T6[Step 6/9]
    UU -.-> T7[Step 7/9]
    XX -.-> T8[Step 8/9]
    QQQ -.-> T9[Step 9/9]
    
    %% Styling
    classDef startEnd fill:#e1f5fe,stroke:#01579b,stroke-width:3px
    classDef process fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef decision fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef llm fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef result fill:#fff9c4,stroke:#f57f17,stroke-width:2px
    classDef progress fill:#fce4ec,stroke:#880e4f,stroke-width:1px
    
    class A,QQQ,SSS startEnd
    class C,I,N,AA,UU,XX process
    class B,D,J,O,V,CC,GG,PP,TT,FFF,PPP decision
    class P,R,S,T,U,DD,FF llm
    class QQ,OO,WW result
    class T1,T2,T3,T4,T5,T6,T7,T8,T9 progress